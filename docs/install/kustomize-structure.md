# About the kustomization structure

The kustomization directories are slightly more complex than the average operator due to the dependancy on `cass-operator`. We deploy `cass-operator` using the manifests from Github to ensure that we remain up to date.

## Objectives

We want to achieve the following:

1. Minimal modifications to the `config/` directory initially created by `operator-sdk`.
2. All remote operator manifests are pulled from their home GH repositories, not kept locally.
3. All local operator manifests come directly from `config/`.

## Design

The kustomization directories are as follows. Any kustomizations not generated by `operator-sdk` are stored in `aux-config/` rather than the templated `config/` directory. This is where we deploy k8ssandra-operator from when we want to include all its dependancies. 

```
   ┌──────────────┐                 ┌───────────────┐
   │ control_plane│                 │ cass-operator │
   └─────────────┬┘                 └──────▲────────┘
                 │                         │
                 │          ┌───────┐      │
                 └──────────►default├──────┤
                            └───▲───┘      │
    ┌─────────────┐             │          │
    │  data_plane ├─────────────┘          │
    └─────────────┘                        │
                                           │
                               ┌───────────▼─────────────────────┐
                               │k8ssandra-operator/config/default│
                               └────┬───────────┬────────────┬───┘
                                    │           │            │
                                    │           │            │
                                ┌───▼───┐   ┌───▼───┐   ┌────▼──┐
                                │ rbac  │   │ crd   │   │manager│
                                └───────┘   └───────┘   └───────┘
```